# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂ –∞–ø—Ç–µ—á–Ω–æ–π —Å–µ—Ç–∏ - SQL Portfolio Project

## üìä –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –∞–ø—Ç–µ—á–Ω–æ–π —Å–µ—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–∏–Ω—Å–∞–π—Ç–æ–≤ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã.

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö:

**–¢–∞–±–ª–∏—Ü–∞ 1: pharma_orders**
- `pharmacy_name` - –ù–∞–∑–≤–∞–Ω–∏–µ –∞–ø—Ç–µ–∫–∏
- `order_id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞
- `drug` - –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
- `price` - –¶–µ–Ω–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
- `count` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü
- `city` - –ì–æ—Ä–æ–¥ –∑–∞–∫–∞–∑–∞
- `report_date` - –î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ (—Å—Ç—Ä–æ–∫–∞, —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è)
- `customer_id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞

**–¢–∞–±–ª–∏—Ü–∞ 2: customers**
- `customer_id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞
- `date_of_birth` - –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∞, —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è)
- `first_name` - –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞
- `last_name` - –§–∞–º–∏–ª–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- `second_name` - –û—Ç—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–∞
- `gender` - –ü–æ–ª –∫–ª–∏–µ–Ω—Ç–∞

## üìà –ö–ª—é—á–µ–≤—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 1. –¢–æ–ø-3 –∞–ø—Ç–µ–∫–∏ –ø–æ –æ–±—ä–µ–º—É –ø—Ä–æ–¥–∞–∂
```sql
SELECT pharmacy_name, SUM(price * count) as total_sales
FROM pharma_orders 
GROUP BY pharmacy_name 
ORDER BY total_sales DESC 
LIMIT 3;
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—ã—è–≤–ª–µ–Ω—ã –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ —Å–µ—Ç–∏ –¥–ª—è —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.

### 2. –¢–æ–ø-3 –ª–µ–∫–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
```sql
SELECT drug, SUM(price * count) as total_sales
FROM pharma_orders 
GROUP BY drug 
ORDER BY total_sales DESC 
LIMIT 3;
```
**–ò–Ω—Å–∞–π—Ç:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–∫–ª–∞–¥—Å–∫–∏—Ö –∑–∞–ø–∞—Å–æ–≤.

### 3. –ê–ø—Ç–µ–∫–∏ —Å –æ–±–æ—Ä–æ—Ç–æ–º —Å–≤—ã—à–µ 1.8 –º–ª–Ω —Ä—É–±–ª–µ–π
```sql
SELECT pharmacy_name, SUM(price * count) as total_revenue
FROM pharma_orders 
GROUP BY pharmacy_name 
HAVING SUM(price * count) > 1800000;
```
**–ë–∏–∑–Ω–µ—Å-–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–¥–µ–ª–µ–Ω—ã –≤—ã—Å–æ–∫–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫.

### 4. –ê–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã –ø–æ –∞–ø—Ç–µ–∫–∞–º
```sql
SELECT po.pharmacy_name, COUNT(DISTINCT po.customer_id) as unique_customers
FROM pharma_orders po
JOIN customers c ON po.customer_id = c.customer_id
GROUP BY po.pharmacy_name
ORDER BY unique_customers DESC;
```
**–ú–µ—Ç—Ä–∏–∫–∞:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.

### 5. –†–µ–π—Ç–∏–Ω–≥ –ª—É—á—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
```sql
WITH ranked_customers AS (
    SELECT 
        po.customer_id,
        CONCAT(c.first_name, ' ', c.last_name) as customer_name,
        SUM(po.price * po.count) as total_spent,
        ROW_NUMBER() OVER (ORDER BY SUM(po.price * po.count) DESC) as rank
    FROM pharma_orders po
    JOIN customers c ON po.customer_id = c.customer_id
    GROUP BY po.customer_id, c.first_name, c.last_name
)
SELECT customer_id, customer_name, total_spent, rank
FROM ranked_customers
WHERE rank <= 10;
```
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ VIP-–∫–ª–∏–µ–Ω—Ç–æ–≤.

## üéØ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂
```sql
SELECT pharmacy_name, report_date, SUM(price * count) as daily_sales,
       SUM(SUM(price * count)) OVER (PARTITION BY pharmacy_name ORDER BY report_date) as cumulative_sales
FROM pharma_orders 
GROUP BY pharmacy_name, report_date;
```

### –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∞–ø—Ç–µ–∫
```sql
WITH gorzdrav_customers AS (
    -- –¢–æ–ø –∫–ª–∏–µ–Ω—Ç—ã –ì–æ—Ä–∑–¥—Ä–∞–≤
),
zdravsiti_customers AS (
    -- –¢–æ–ø –∫–ª–∏–µ–Ω—Ç—ã –ó–¥—Ä–∞–≤—Å–∏—Ç–∏
)
-- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–î–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

### –î–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏:
1. **–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ –ø–æ –∞–ø—Ç–µ–∫–∞–º
2. **–°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞** - —Ç–æ–ø-10 –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ
3. **–õ–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫** - –¥–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
4. **–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞** - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏

### –ü—Ä–∏–º–µ—Ä Python –∫–æ–¥–∞ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
```python
import matplotlib.pyplot as plt
import pandas as pd

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQL –∑–∞–ø—Ä–æ—Å–∞
df = pd.read_sql_query("""
    SELECT pharmacy_name, SUM(price * count) as sales 
    FROM pharma_orders 
    GROUP BY pharmacy_name
""", connection)

plt.figure(figsize=(10,6))
plt.bar(df['pharmacy_name'], df['sales'])
plt.title('–ü—Ä–æ–¥–∞–∂–∏ –ø–æ –∞–ø—Ç–µ–∫–∞–º')
plt.xticks(rotation=45)
plt.show()
```

## üí° –ë–∏–∑–Ω–µ—Å-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞
- –£–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–ø–∞—Å—ã —Ç–æ–ø-3 –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å —Å–ø—Ä–æ—Å–∞

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º –æ–ø—ã—Ç–æ–º
- –í–Ω–µ–¥—Ä–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ç–æ–ø-–∫–ª–∏–µ–Ω—Ç–æ–≤
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫

### 3. –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —É—Å–∏–ª–∏—è –Ω–∞ –≤—ã—Å–æ–∫–æ–¥–æ—Ö–æ–¥–Ω—ã—Ö –∞–ø—Ç–µ–∫–∞—Ö
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã based on –ø–∏–∫–æ–≤—ã–º —á–∞—Å–∞–º –ø—Ä–æ–¥–∞–∂

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞—Ç:
```sql
-- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞–º–∏
SELECT 
    report_date::date as formatted_date,
    date_of_birth::date as birth_date
FROM your_tables;
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
1. –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
3. –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏


## üöÄ –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

1. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞** –≤ Power BI/Tableau
2. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏** —á–µ—Ä–µ–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
3. **ML-–º–æ–¥–µ–ª–∏** –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∂
4. **Real-time –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

*–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ SQL –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ü–µ–Ω–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–∏–Ω—Å–∞–π—Ç–æ–≤ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è PostgreSQL –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production-—Å—Ä–µ–¥–µ.*

**–ê–≤—Ç–æ—Ä:** [singaevsky](https://github.com/singaevsky)  
**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 05 –æ–∫—Ç—è–±—Ä—è 2025# portfolio_sql
