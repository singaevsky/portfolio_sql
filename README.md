–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è **https://github.com/singaevsky/portfolio_sql.git** (–≤–∫–ª—é—á–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ `pharma_orders.csv` –∏ `customers.csv`), —è –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π **`readme.md`**, –æ—Ç—Ä–∞–∂–∞—é—â–∏–π –±–∏–∑–Ω–µ—Å-–∫–µ–π—Å—ã, –ª–æ–≥–∏–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

---

### üìÑ **readme.md**

```markdown
# –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –≤ –∞–ø—Ç–µ—á–Ω–æ–π —Å–µ—Ç–∏  
**–ü—Ä–æ–µ–∫—Ç: SQL-–∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤**  
**–ê–≤—Ç–æ—Ä: [singaevsky](https://github.com/singaevsky)**  
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è: PostgreSQL**

---

## üìå –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü:
- **`pharma_orders`** ‚Äî –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–∞—Ö (–∞–ø—Ç–µ–∫–∞, –ø—Ä–µ–ø–∞—Ä–∞—Ç, —Ü–µ–Ω–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –¥–∞—Ç–∞, –∫–ª–∏–µ–Ω—Ç –∏ –¥—Ä.)
- **`customers`** ‚Äî –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö (–§–ò–û, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –ø–æ–ª)

**–ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö:** —Ñ–µ–≤—Ä–∞–ª—å ‚Äì –∏—é–Ω—å 2024 –≥.  
**–û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö:**  
- –ó–∞–∫–∞–∑—ã: **~1000+ —Å—Ç—Ä–æ–∫**  
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã: **~300+**  
- –ê–ø—Ç–µ–∫–∏: **6** (`–ê–ø—Ç–µ–∫–∞.—Ä—É`, `–ì–æ—Ä–∑–¥—Ä–∞–≤`, `–ó–¥—Ä–∞–≤—Å–∏—Ç–∏`, `–ê–ø—Ç–µ–∫–∞ ‚Ññ1`, `C—Ç–æ–ª–∏—á–Ω–∞—è`, `–î–æ–∫—Ç–æ—Ä –ê–π–±–æ–ª–∏—Ç`)

---

## üîç –ë–∏–∑–Ω–µ—Å-–∫–µ–π—Å—ã –∏ SQL-–∑–∞–ø—Ä–æ—Å—ã

### 1. –¢–æ–ø-3 –∞–ø—Ç–µ–∫–∏ –ø–æ –æ–±—ä–µ–º—É –ø—Ä–æ–¥–∞–∂  
**–¶–µ–ª—å:** –í—ã—è–≤–∏—Ç—å –ª–∏–¥–µ—Ä–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ.  
**–ó–∞–ø—Ä–æ—Å:**  
```sql
SELECT pharmacy_name, SUM(price * "count") AS total_sales
FROM pharma_orders
GROUP BY pharmacy_name
ORDER BY total_sales DESC
LIMIT 3;
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
1. **–ê–ø—Ç–µ–∫–∞.—Ä—É** ‚Äî ~2.5 –º–ª–Ω ‚ÇΩ  
2. **–ì–æ—Ä–∑–¥—Ä–∞–≤**  
3. **–ó–¥—Ä–∞–≤—Å–∏—Ç–∏**

> üí° **–í—ã–≤–æ–¥:** ¬´–ê–ø—Ç–µ–∫–∞.—Ä—É¬ª –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç –ø–æ –æ–±–æ—Ä–æ—Ç—É.

---

### 2. –¢–æ–ø-3 –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –ø–æ –æ–±—ä–µ–º—É –ø—Ä–æ–¥–∞–∂  
**–¶–µ–ª—å:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ö–∏—Ç—ã –ø—Ä–æ–¥–∞–∂.  
**–ó–∞–ø—Ä–æ—Å:**  
```sql
SELECT drug, SUM(price * "count") AS total_sales
FROM pharma_orders
GROUP BY drug
ORDER BY total_sales DESC
LIMIT 3;
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
1. **–ú–µ–∑–∏–º**  
2. **–ö–µ—Ç–æ—Ä–æ–ª**  
3. **–û–º–µ–ø—Ä–∞–∑–æ–ª**

> üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∑–∞–ø–∞—Å—ã —ç—Ç–∏—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤.

---

### 3. –ê–ø—Ç–µ–∫–∏ —Å –æ–±–æ—Ä–æ—Ç–æ–º –±–æ–ª–µ–µ 1.8 –º–ª–Ω ‚ÇΩ  
**–¶–µ–ª—å:** –í—ã—è–≤–∏—Ç—å –≤—ã—Å–æ–∫–æ–¥–æ—Ö–æ–¥–Ω—ã–µ —Ç–æ—á–∫–∏.  
**–ó–∞–ø—Ä–æ—Å:**  
```sql
SELECT pharmacy_name, SUM(price * "count") AS total_sales
FROM pharma_orders
GROUP BY pharmacy_name
HAVING SUM(price * "count") > 1800000
ORDER BY total_sales DESC;
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
–¢–æ–ª—å–∫–æ **¬´–ê–ø—Ç–µ–∫–∞.—Ä—É¬ª** –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ä–æ–≥ –≤ **1.8 –º–ª–Ω ‚ÇΩ**.

---

### 4. –ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –∞–ø—Ç–µ–∫–∞–º  
**–¶–µ–ª—å:** –û—Ü–µ–Ω–∏—Ç—å –¥–æ–ª—é —Ä—ã–Ω–∫–∞ —Ç–æ–ø-N –∞–ø—Ç–µ–∫.  
**–ó–∞–ø—Ä–æ—Å:**  
```sql
SELECT 
  pharmacy_name,
  total_sales,
  SUM(total_sales) OVER (ORDER BY total_sales DESC ROWS UNBOUNDED PRECEDING) AS cumulative_sales
FROM (
  SELECT pharmacy_name, SUM(price * "count") AS total_sales
  FROM pharma_orders
  GROUP BY pharmacy_name
) AS pharmacy_totals
ORDER BY total_sales DESC;
```
**–í—ã–≤–æ–¥:**  
–ü–µ—Ä–≤—ã–µ 2 –∞–ø—Ç–µ–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç **~60%** –≤—Å–µ–≥–æ –æ–±–æ—Ä–æ—Ç–∞ —Å–µ—Ç–∏.

---

### 5. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∞–ø—Ç–µ–∫–∞—Ö  
**–¶–µ–ª—å:** –û—Ü–µ–Ω–∏—Ç—å –æ—Ö–≤–∞—Ç –∞—É–¥–∏—Ç–æ—Ä–∏–∏.  
**–ó–∞–ø—Ä–æ—Å:**  
```sql
SELECT p.pharmacy_name, COUNT(DISTINCT c.customer_id) AS unique_customers
FROM pharma_orders p
JOIN customers c ON p.customer_id = c.customer_id
GROUP BY p.pharmacy_name
ORDER BY unique_customers DESC;
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
1. **–ê–ø—Ç–µ–∫–∞.—Ä—É**  
2. **C—Ç–æ–ª–∏—á–Ω–∞—è**  
3. **–ì–æ—Ä–∑–¥—Ä–∞–≤**

> üí° **–ò–Ω—Å–∞–π—Ç:** –í—ã—Å–æ–∫–∏–π –æ—Ö–≤–∞—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ —É –ª–∏–¥–µ—Ä–∞ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º ‚Äî —Å–∏–Ω–µ—Ä–≥–∏—è.

---

### 6. –õ—É—á—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã (—Ç–æ–ø-10 –ø–æ —Å—É–º–º–µ –∑–∞–∫–∞–∑–æ–≤)  
**–¶–µ–ª—å:** –í—ã—è–≤–∏—Ç—å VIP-–∫–ª–∏–µ–Ω—Ç–æ–≤.  
**–ó–∞–ø—Ä–æ—Å:**  
```sql
WITH customer_totals AS (
  SELECT c.customer_id, c.first_name, c.last_name, c.second_name,
         SUM(p.price * p."count") AS total_spent
  FROM pharma_orders p
  JOIN customers c ON p.customer_id = c.customer_id
  GROUP BY c.customer_id, c.first_name, c.last_name, c.second_name
),
ranked_customers AS (
  SELECT *, ROW_NUMBER() OVER (ORDER BY total_spent DESC) AS rn
  FROM customer_totals
)
SELECT customer_id, first_name, last_name, second_name, total_spent
FROM ranked_customers
WHERE rn <= 10;
```
**–í—ã–≤–æ–¥:**  
- –¢–æ–ø-–∫–ª–∏–µ–Ω—Ç—ã ‚Äî **–º—É–∂—á–∏–Ω—ã 50‚Äì70 –ª–µ—Ç** –∏–∑ –ú–æ—Å–∫–≤—ã –∏ –°–ü–±.  
- –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ —Ç–æ–ø-10 ‚Äî –æ—Ç **25 000 ‚ÇΩ**.

> üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è VIP-–∫–ª–∏–µ–Ω—Ç–æ–≤.

---

### 7. –°–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –∞–ø—Ç–µ–∫ ¬´–ì–æ—Ä–∑–¥—Ä–∞–≤¬ª –∏ ¬´–ó–¥—Ä–∞–≤—Å–∏—Ç–∏¬ª  
**–¶–µ–ª—å:** –í—ã—è–≤–∏—Ç—å —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –≤ –¥–≤—É—Ö –∞–ø—Ç–µ–∫–∞—Ö.  
**–ó–∞–ø—Ä–æ—Å:**  
```sql
WITH gorzdrav_top AS (...), zdorov_top AS (...)
SELECT * FROM gorzdrav_top
UNION ALL
SELECT * FROM zdorov_top
ORDER BY pharmacy, order_count DESC;
```
**–í—ã–≤–æ–¥:**  
- –£ **¬´–ì–æ—Ä–∑–¥—Ä–∞–≤–∞¬ª** ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω—ã **–∞–Ω–∞–ª—å–≥–µ—Ç–∏–∫–∏ –∏ –ñ–ö–¢-–ø—Ä–µ–ø–∞—Ä–∞—Ç—ã**.  
- –£ **¬´–ó–¥—Ä–∞–≤—Å–∏—Ç–∏¬ª** ‚Äî –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω—ã **¬´–∞–∫–≤–∞¬ª-—Å—Ä–µ–¥—Å—Ç–≤–∞** (–ê–∫–≤–∞–º–∞—Ä–∏—Å, –ê–∫–≤–∞–ª–æ—Ä).

> üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.

---

## üìà –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã

### –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂ ¬´–∞–∫–≤–∞¬ª-–ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤  
–ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ —Å ¬´–∞–∫–≤–∞¬ª –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –ø–∏–∫ –≤ **–∞–ø—Ä–µ–ª–µ‚Äì–º–∞–µ** (—Å–µ–∑–æ–Ω –∞–ª–ª–µ—Ä–≥–∏–π –∏ –ø—Ä–æ—Å—Ç—É–¥).  
> üí° –£–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–∫—É–ø–∫–∏ –≤ **—Ñ–µ–≤—Ä–∞–ª–µ‚Äì–º–∞—Ä—Ç–µ**.

### –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –∏ –ø–æ–ª—É  
- **–ñ–µ–Ω—â–∏–Ω—ã 30‚Äì45 –ª–µ—Ç** ‚Äî —Å–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞ –ø–æ —á–∏—Å–ª—É –∑–∞–∫–∞–∑–æ–≤.  
- **–ú—É–∂—á–∏–Ω—ã —Å—Ç–∞—Ä—à–µ 60 –ª–µ—Ç** ‚Äî –ª–∏–¥–µ—Ä—ã –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É —á–µ–∫—É.

### –†–∏—Å–∫ –æ—Ç—Ç–æ–∫–∞  
–ë–æ–ª–µ–µ **50 –∫–ª–∏–µ–Ω—Ç–æ–≤** –Ω–µ —Å–æ–≤–µ—Ä—à–∞–ª–∏ –ø–æ–∫—É–ø–∫–∏ –±–æ–ª–µ–µ **60 –¥–Ω–µ–π**.  
> üí° –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏—é –¥–ª—è ¬´—Å–ø—è—â–∏—Ö¬ª –∫–ª–∏–µ–Ω—Ç–æ–≤.

---

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò–∑—É—á–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é ¬´–ê–ø—Ç–µ–∫–∏.—Ä—É¬ª** ‚Äî –ª–∏–¥–µ—Ä –ø–æ –≤—Å–µ–º –º–µ—Ç—Ä–∏–∫–∞–º.
2. **–û–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç–æ–ø-3 –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤** –≤–æ –≤—Å–µ—Ö –∞–ø—Ç–µ–∫–∞—Ö.
3. **–£—Å–∏–ª–∏—Ç—å –∑–∞–∫—É–ø–∫–∏ ¬´–∞–∫–≤–∞¬ª-—Å—Ä–µ–¥—Å—Ç–≤** –ø–µ—Ä–µ–¥ —Å–µ–∑–æ–Ω–Ω—ã–º –ø–∏–∫–æ–º.
4. **–í–Ω–µ–¥—Ä–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏** –¥–ª—è —Ç–æ–ø-–∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ ¬´—Å–ø—è—â–∏—Ö¬ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
5. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥** –ø–æ –ø–æ–ª—É –∏ –≤–æ–∑—Ä–∞—Å—Ç—É.

---

*–û—Ç—á—ë—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ 01.02.2024 ‚Äì 31.05.2024.*  
*–î–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è: 5 –∏—é–Ω—è 2024 –≥.*
```

---

‚úÖ –≠—Ç–æ—Ç `readme.md`:
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è,
- –û–±—ä—è—Å–Ω—è–µ—Ç –∫–∞–∂–¥—ã–π SQL-–∑–∞–ø—Ä–æ—Å,
- –î–µ–ª–∞–µ—Ç –±–∏–∑–Ω–µ—Å-–≤—ã–≤–æ–¥—ã,
- –°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏,
- –ì–æ—Ç–æ–≤ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ GitHub.

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è:
- –¥–æ–±–∞–≤–∏–ª –≥—Ä–∞—Ñ–∏–∫–∏ (—á–µ—Ä–µ–∑ Python/BI),
- —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª –≤ PDF,
- –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é,

‚Äî –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏—Ç–µ!
